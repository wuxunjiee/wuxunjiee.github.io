<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue UI 组件库搭建（造轮子） | Hello 艾瑞巴蒂</title>
    <meta name="description" content="Just playing around">
    
    
    <link rel="preload" href="/assets/css/0.styles.d4d1289e.css" as="style"><link rel="preload" href="/assets/js/app.4d2af8dc.js" as="script"><link rel="preload" href="/assets/js/2.65618a35.js" as="script"><link rel="preload" href="/assets/js/28.2d5b03bb.js" as="script"><link rel="prefetch" href="/assets/js/10.2b2b1bcc.js"><link rel="prefetch" href="/assets/js/11.a920e6fd.js"><link rel="prefetch" href="/assets/js/12.76b518ab.js"><link rel="prefetch" href="/assets/js/13.1209b5d9.js"><link rel="prefetch" href="/assets/js/14.57f675fa.js"><link rel="prefetch" href="/assets/js/15.57a8dbde.js"><link rel="prefetch" href="/assets/js/16.2fb9d621.js"><link rel="prefetch" href="/assets/js/17.9b847a20.js"><link rel="prefetch" href="/assets/js/18.952a441d.js"><link rel="prefetch" href="/assets/js/19.eb35c370.js"><link rel="prefetch" href="/assets/js/20.04dc599b.js"><link rel="prefetch" href="/assets/js/21.b47da30a.js"><link rel="prefetch" href="/assets/js/22.7d9f602f.js"><link rel="prefetch" href="/assets/js/23.e96add05.js"><link rel="prefetch" href="/assets/js/24.74d818cd.js"><link rel="prefetch" href="/assets/js/25.d99bd3f2.js"><link rel="prefetch" href="/assets/js/26.6bf91b73.js"><link rel="prefetch" href="/assets/js/27.ebfd6b02.js"><link rel="prefetch" href="/assets/js/29.2a10bac8.js"><link rel="prefetch" href="/assets/js/3.cccc7907.js"><link rel="prefetch" href="/assets/js/4.9fe59de7.js"><link rel="prefetch" href="/assets/js/5.4e14f0c6.js"><link rel="prefetch" href="/assets/js/6.c2e58b43.js"><link rel="prefetch" href="/assets/js/7.dd9652d4.js"><link rel="prefetch" href="/assets/js/8.805c72ed.js"><link rel="prefetch" href="/assets/js/9.825d3980.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d4d1289e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Hello 艾瑞巴蒂</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/wheel/" class="nav-link router-link-active">轮子</a></div><div class="nav-item"><a href="/Q&amp;A/" class="nav-link">项目总结</a></div><div class="nav-item"><a href="/sass/" class="nav-link">Sass</a></div><div class="nav-item"><a href="/mobile/" class="nav-link">mobile</a></div><div class="nav-item"><a href="/theory/" class="nav-link">深入原理</a></div><div class="nav-item"><a href="/optimize/" class="nav-link">性能优化</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/wheel/" class="nav-link router-link-active">轮子</a></div><div class="nav-item"><a href="/Q&amp;A/" class="nav-link">项目总结</a></div><div class="nav-item"><a href="/sass/" class="nav-link">Sass</a></div><div class="nav-item"><a href="/mobile/" class="nav-link">mobile</a></div><div class="nav-item"><a href="/theory/" class="nav-link">深入原理</a></div><div class="nav-item"><a href="/optimize/" class="nav-link">性能优化</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/wheel/" class="sidebar-link">让 storage 像操作对象一样简单</a></li><li><a href="/wheel/factory.html" class="active sidebar-link">Vue UI 组件库搭建（造轮子）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wheel/factory.html#第一步-创建项目-选择开源协议" class="sidebar-link">第一步 创建项目 -&gt; 选择开源协议</a></li><li class="sidebar-sub-header"><a href="/wheel/factory.html#第二步-单元测试" class="sidebar-link">第二步 单元测试</a></li><li class="sidebar-sub-header"><a href="/wheel/factory.html#第三步-使用-travis-ci-持续集成" class="sidebar-link">第三步 使用 Travis CI 持续集成</a></li><li class="sidebar-sub-header"><a href="/wheel/factory.html#第四步-npm发布自己的包" class="sidebar-link">第四步 npm发布自己的包</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-ui-组件库搭建（造轮子）"><a href="#vue-ui-组件库搭建（造轮子）" class="header-anchor">#</a> Vue UI 组件库搭建（造轮子）</h1> <h2 id="第一步-创建项目-选择开源协议"><a href="#第一步-创建项目-选择开源协议" class="header-anchor">#</a> 第一步 创建项目 -&gt; 选择开源协议</h2> <p><img src="/wheel/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE.jpg" alt="开源协议"></p> <ul><li>一直选绿色的按钮点击</li></ul> <p><img src="/wheel/%E5%BC%80%E6%BA%90%E5%8D%8F%E8%AE%AE2.jpg" alt="开源协议"></p> <p><strong>安装 parcel 构建工具</strong></p> <ul><li>命令</li> <li>npm install -g parcel-bundler</li> <li>npm i -g git-open 安装后运行 git open 可以直接打开自己的 git 仓库</li> <li>git init</li> <li>npm install vue</li></ul> <p><strong>项目搭建</strong></p> <ul><li>创建.gitignore 文件
node_modules/
.cache/ 不上传缓存文件</li></ul> <p>package.json 添加</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;alias&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token property">&quot;vue&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;./node_modules/vue/dist/vue.common.js&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>详情见 Vue 文档</p> <p><strong>打包命令</strong>
./node_modules/.bin/parcel 或者 ./node_modules/.bin/parcel --no-cache 清楚缓存
或者觉得命令太长太难记了,它会在当前目录去找执行
npx parcel</p> <h2 id="第二步-单元测试"><a href="#第二步-单元测试" class="header-anchor">#</a> 第二步 单元测试</h2> <p><strong>使用 Karma+Mocha 进行单元测试</strong></p> <ul><li>Karma(卡码)是一个测试运行器，它可以呼起浏览器，加载测试脚本，然后运行测试用例</li> <li>Mocha(摩卡)是一个单元测试框架/库，它可以用来写测试用例</li> <li>Sinon(西农)是一个 spy/stub/mock 库，用以辅助测试</li></ul> <p><strong>安装</strong></p> <div class="language-json extra-class"><pre class="language-json"><code>sudo npm i -D karma karma-chrome-launcher karma-mocha karma-sinon-chai mocha sinon sinon-chai karma-chai karma-chai-spies
</code></pre></div><p><strong>创建 karma.conf.js 文件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// base path that will be used to resolve all patterns (eg. files, exclude)</span>
    basePath<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// frameworks to use</span>
    <span class="token comment">// available frameworks: https://npmjs.org/browse/keyword/karma-adapter</span>
    frameworks<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;mocha&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sinon-chai&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    client<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      chai<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        includeStack<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// list of files / patterns to load in the browser</span>
    files<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;dist/**/*.test.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dist/**/*.test.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// list of files / patterns to exclude</span>
    exclude<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// preprocess matching files before serving them to the browser</span>
    <span class="token comment">// available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span>
    preprocessors<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// test results reporter to use</span>
    <span class="token comment">// possible values: 'dots', 'progress'</span>
    <span class="token comment">// available reporters: https://npmjs.org/browse/keyword/karma-reporter</span>
    reporters<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;progress&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// web server port</span>
    port<span class="token punctuation">:</span> <span class="token number">9876</span><span class="token punctuation">,</span>

    <span class="token comment">// enable / disable colors in the output (reporters and logs)</span>
    colors<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// level of logging</span>
    <span class="token comment">// possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span>
    logLevel<span class="token punctuation">:</span> config<span class="token punctuation">.</span><span class="token constant">LOG_INFO</span><span class="token punctuation">,</span>

    <span class="token comment">// enable / disable watching file and executing tests whenever any file changes</span>
    autoWatch<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

    <span class="token comment">// start these browsers</span>
    <span class="token comment">// available browser launchers: https://npmjs.org/browse/keyword/karma-launcher</span>
    <span class="token comment">//无头谷歌浏览器，直接写Chrome自动化测试有时会有问题，无头就是没有浏览器界面显示</span>
    browsers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;ChromeHeadless&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token comment">// Continuous Integration mode</span>
    <span class="token comment">// if true, Karma captures browsers, runs the tests and exits</span>
    singleRun<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>

    <span class="token comment">// Concurrency level</span>
    <span class="token comment">// how many browser should be started simultaneous</span>
    concurrency<span class="token punctuation">:</span> <span class="token number">Infinity</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>创建 test/button.test.js 文件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> expect <span class="token operator">=</span> chai<span class="token punctuation">.</span>expect<span class="token punctuation">;</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Button <span class="token keyword">from</span> <span class="token string">&quot;../src/button&quot;</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>productionTip <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>devtools <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&quot;Button&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;存在.&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>exist<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;可以设置icon.&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        icon<span class="token punctuation">:</span> <span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> useElement <span class="token operator">=</span> vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;use&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>useElement<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;xlink:href&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">&quot;#i-settings&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;可以设置loading.&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        icon<span class="token punctuation">:</span> <span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span>
        loading<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> useElements <span class="token operator">=</span> vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;use&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>useElements<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>useElements<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;xlink:href&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">&quot;#i-loading&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;icon 默认的 order 是 1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        icon<span class="token punctuation">:</span> <span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> icon <span class="token operator">=</span> vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>icon<span class="token punctuation">)</span><span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;设置 iconPosition 可以改变 order&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        icon<span class="token punctuation">:</span> <span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span>
        iconPosition<span class="token punctuation">:</span> <span class="token string">&quot;right&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> icon <span class="token operator">=</span> vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>icon<span class="token punctuation">)</span><span class="token punctuation">.</span>order<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">&quot;点击 button 触发 click 事件&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> Constructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      propsData<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        icon<span class="token punctuation">:</span> <span class="token string">&quot;settings&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> callback <span class="token operator">=</span> sinon<span class="token punctuation">.</span><span class="token function">fake</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    vm<span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>have<span class="token punctuation">.</span>been<span class="token punctuation">.</span>called<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这样写有单独的文件进行管理，不需要使用大括号分隔每个测试用例 it('描述')看起来更有语义化</p> <p>--no-cache 不要缓存 --no-minify 不要最小化压缩文件 不加这两条有时会有些奇怪的 Bug</p> <h2 id="第三步-使用-travis-ci-持续集成"><a href="#第三步-使用-travis-ci-持续集成" class="header-anchor">#</a> 第三步 使用 Travis CI 持续集成</h2> <ul><li>根目录创建.travis.yml 文件</li></ul> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">language</span><span class="token punctuation">:</span> node_js
<span class="token key atrule">node_js</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;8&quot;</span>
<span class="token key atrule">addons</span><span class="token punctuation">:</span>
  <span class="token key atrule">chrome</span><span class="token punctuation">:</span> stable
<span class="token key atrule">sudo</span><span class="token punctuation">:</span> required
<span class="token comment">#指定分支，只有指定的分支提交时才会运行脚本</span>
<span class="token key atrule">branches</span><span class="token punctuation">:</span>
  <span class="token key atrule">only</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> dev<span class="token punctuation">-</span>1.0.0
<span class="token key atrule">before_script</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;sudo chown root /opt/google/chrome/chrome-sandbox&quot;</span>
  <span class="token punctuation">-</span> <span class="token string">&quot;sudo chmod 4755 /opt/google/chrome/chrome-sandbox&quot;</span>
</code></pre></div><ul><li>使用github登录</li></ul> <p><img src="/wheel/%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90-TravisCI%E7%99%BB%E5%BD%95.png" alt="持续集成"></p> <ul><li>授权</li></ul> <p><img src="/wheel/%E6%8E%88%E6%9D%831.png" alt="持续集成"> <img src="/wheel/%E6%8E%88%E6%9D%832.png" alt="持续集成"> <img src="/wheel/%E6%8E%88%E6%9D%833.png" alt="持续集成"></p> <ul><li>选择你需要开启管理的仓库</li></ul> <p><img src="/wheel/%E9%80%89%E6%8B%A9%E4%BB%93%E5%BA%93.png" alt="持续集成"></p> <p><strong>每次往github远程仓库提交代码，travis会自动去进行编译测试</strong></p> <ul><li>单元测试通过
<img src="/wheel/%E6%B5%8B%E8%AF%95%E9%80%9A%E8%BF%87.png" alt="持续集成"></li> <li>单元测试失败
<img src="/wheel/%E6%B5%8B%E8%AF%95%E5%A4%B1%E8%B4%A5.png" alt="持续集成"></li> <li>单元测试日志
<img src="/wheel/%E6%B5%8B%E8%AF%95%E5%A4%B1%E8%B4%A5%E6%97%A5%E5%BF%97.png" alt="持续集成"></li></ul> <p><strong>如果测试由上次通过状态变为失败或者由失败变为成功都会给你github绑定的邮箱发送一份邮件</strong></p> <p><img src="/wheel/%E9%82%AE%E7%AE%B1%E6%8F%90%E9%86%92.png" alt="持续集成"></p> <h2 id="第四步-npm发布自己的包"><a href="#第四步-npm发布自己的包" class="header-anchor">#</a> 第四步 npm发布自己的包</h2> <ul><li>package.json文件version:'0.0.1'</li> <li>package.json文件的&quot;main&quot;:&quot;index.js&quot;入口文件要与新创建的index.js名称一致</li></ul> <p><strong>npm账户注册</strong> <img src="/wheel/npm%E8%B4%A6%E5%8F%B7%E6%B3%A8%E5%86%8C.png" alt="持续集成"></p> <ul><li><p>在终端运行npm adduser</p></li> <li><p>在终端运行npm publish上传包</p></li> <li><p>记得要切换源 npm config set registry=http://registry.npmjs.org</p></li> <li><p>注册npm账户后要登录邮箱激活</p></li> <li><p>package.json中的name要全小写</p></li> <li><p>npm包发布成功后npm i安装如果提示没有权限报错 输入命名 sudo chown -R $(whoami) ~/.npm再重新安装就好了</p></li> <li><p>npm安装后使用发布的包，引入Button等组件，发现报错，原因是目前浏览器不支持import这种语法，我们用babel编译后再提供给用户使用<strong>parcel build index.js --no-cache --no-minify</strong>,且package.json中&quot;main&quot;: &quot;dist/index.js&quot;进行修改</p></li> <li><p>用户在使用时目前使用引入组件，注册组件，引入组件库css，引入定义的样式变量,引入svg文件且每改动代码需要重新发包，每次发包需要改package.json中版本号</p></li></ul> <h3 id="现在有个问题我们每次改了代码都要重新打包，然后用户再重新安装，这样非常麻烦，我们该怎么解决呢？"><a href="#现在有个问题我们每次改了代码都要重新打包，然后用户再重新安装，这样非常麻烦，我们该怎么解决呢？" class="header-anchor">#</a> 现在有个问题我们每次改了代码都要重新打包，然后用户再重新安装，这样非常麻烦，我们该怎么解决呢？</h3> <ul><li>在我们自己的组件库项目终端输入yarn link 再到用户的项目yarn link 包名 每次改动了代码要parcel build index.js --no-cache --no-minify这样就不需要每次都发包再安装了</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/wheel/" class="prev router-link-active">让 storage 像操作对象一样简单</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4d2af8dc.js" defer></script><script src="/assets/js/2.65618a35.js" defer></script><script src="/assets/js/28.2d5b03bb.js" defer></script>
  </body>
</html>
